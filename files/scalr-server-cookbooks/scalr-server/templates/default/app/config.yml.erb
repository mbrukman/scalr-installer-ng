scalr:
  connections:
    mysql: &connections_mysql
      host: <%= node[:scalr_server][:mysql][:host] %>
      port: <%= node[:scalr_server][:mysql][:port] %>
      user: <%= node[:scalr_server][:mysql][:scalr_user] %>
      pass: <%= node[:scalr_server][:mysql][:scalr_password] %>
      name: <%= node[:scalr_server][:mysql][:scalr_dbname] %>

  analytics:
    enabled: yes
    connections:
      analytics:
        <<: *connections_mysql
        name: <%= node[:scalr_server][:mysql][:analytics_dbname] %>
      scalr:
        <<: *connections_mysql
    poller:
      cryptokey: <%= scalr_bundle_path node %>/app/etc/.cryptokey

  email:
    address: <%= node[:scalr_server][:app][:email_from_address] %>
    name: <%= node[:scalr_server][:app][:email_from_name] %>

  auth_mode: scalr

  instances_connection_policy: <%= node[:scalr_server][:app][:instances_connection_policy] %>

  allowed_clouds:
  - ec2
  - gce
  - eucalyptus
  - cloudstack
  - idcf
  - openstack
  - ocs
  - ecs
  - rackspacenguk
  - rackspacengus
  - nebula

  endpoint:
    scheme: <%= node[:scalr_server][:routing][:endpoint_scheme] %>
    host: <%= node[:scalr_server][:routing][:endpoint_host] %>

  aws:
    ip_pool: ['<%= node[:scalr_server][:app][:ip_range] %>']
    security_group_name: scalr.<%= node[:scalr_server][:app][:id] %>.ip-pool

  billing:
    enabled: no

  dns:
    mysql:
      host: 'localhost'
      port: ~
      name: 'scalr'
      user: 'scalr'
      pass: 'scalr'
    static:
      enabled: no
      nameservers: ['ns1.example-dns.net', 'ns2.example-dns.net']
      domain_name: 'example-dns.net'
    global:
      enabled: no
      nameservers: ['ns1.example.net', 'ns2.example.net', 'ns3.example.net', 'ns4.example.net']
      default_domain_name: 'provide.domain.here.in'

  load_statistics:
    connections:
      plotter:
        scheme: <%= node[:scalr_server][:routing][:plotter_scheme] %>
        bind_scheme: <%= node[:scalr_server][:worker][:plotter_bind_scheme] %>
        host: <%= node[:scalr_server][:routing][:plotter_host] %>
        bind_host: <%= node[:scalr_server][:worker][:plotter_bind_host] %>
        bind_address: <%= node[:scalr_server][:worker][:plotter_bind_host] %>  # Deprecated!
        port: <%= node[:scalr_server][:routing][:plotter_port] %>
        bind_port: <%= node[:scalr_server][:worker][:plotter_bind_port] %>
    rrd:
      dir: '<%= data_dir_for node, 'rrd' %>'
      run_dir: '<%= run_dir_for node, 'rrd' %>'
      rrdcached_sock_path: '<%= run_dir_for node, 'rrd' %>/rrdcached.sock'
    img:
      scheme: <%= node[:scalr_server][:routing][:graphics_scheme] %>
      host: <%= node[:scalr_server][:routing][:graphics_host] %>
      path: <%= node[:scalr_server][:routing][:graphics_path] %>
      dir:  '<%= data_dir_for node, 'worker' %>'

  crontab:
    services:
      analytics_notifications:
        enabled: yes
        log: '<%= node[:scalr][:core][:log_dir] %>/analytics_notifications.log'

      cloud_poller:
        enabled: yes
        log: '<%= node[:scalr][:core][:log_dir] %>/cloud_poller.log'

      cloud_pricing:
        enabled: yes
        log: '<%= node[:scalr][:core][:log_dir] %>/cloud_pricing.log'

      db_msr_maintenance:
        enabled: yes
        log: '<%= node[:scalr][:core][:log_dir] %>/db_msr_maintenance.log'

      images_builder:
        enabled: yes
        log: '<%= node[:scalr][:core][:log_dir] %>/images_builder.log'

      images_cleanup:
        enabled: yes
        log: '<%= node[:scalr][:core][:log_dir] %>/images_cleanup.log'

      lease_manager:
        enabled: yes
        log: '<%= node[:scalr][:core][:log_dir] %>/lease_manager.log'

      rotate:
        enabled: yes
        log: '<%= node[:scalr][:core][:log_dir] %>/rotate.log'

      scalarizr_messaging:
        enabled: yes
        log: '<%= node[:scalr][:core][:log_dir] %>/scalarizr_messaging.log'
        replicate:
          type:
          - HostInit
          - BeforeHostUp
          - HostUp

      scaling:
        enabled: yes
        log: '<%= node[:scalr][:core][:log_dir] %>/scaling.log'

      scheduler:
        enabled: yes
        log: '<%= node[:scalr][:core][:log_dir] %>/scheduler.log'

      server_status_manager:
        enabled: yes
        log: '<%= node[:scalr][:core][:log_dir] %>/server_status_manager.log'

      server_terminate:
        enabled: yes
        log: '<%= node[:scalr][:core][:log_dir] %>/server_terminate.log'

  ui:
    mindterm_enabled: true

  scalarizr_update:
    mode: 'client'
    default_repo: 'stable'
    repos:
      latest:
        deb_repo_url: 'http://apt.scalr.net/debian scalr/'
        rpm_repo_url: 'http://rpm.scalr.net/rpm/rhel/$releasever/$basearch'
        win_repo_url: 'http://win.scalr.net'
      stable:
        deb_repo_url: 'http://apt-delayed.scalr.net/debian scalr/'
        rpm_repo_url: 'http://rpm-delayed.scalr.net/rpm/rhel/$releasever/$basearch'
        win_repo_url: 'http://win-delayed.scalr.net'
